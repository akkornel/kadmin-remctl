                    User-Visible kadmin-remctl Changes

kadmin-remctl 3.1 (unreleased)

    kadmin-backend for an MIT Kerberos server no longer has the boolean
    checking configuration parameter, which said whether to do password
    checking.  Instead, there is a new policy configuration parameter
    which, if set, sets that password policy for newly created accounts.
    To duplicate the previous behavior when checking was true, set policy
    to "standard".

    Add an expiration command, which sets the expiration date of a
    principal.  Based on a patch from Garrett Wollman.

    kadmin backend for an MIT Kerberos server now supports the create_opts
    configuration parameter, which adds additional options that are passed
    to kadmin addprinc when a principal is created.  Based on a patch by
    Garrett Wollman.

    Allow underscores in principal names by default in the examine
    function.

kadmin-remctl 3.0 (2010-02-17)

    Add kadmin-backend-heim, which duplicates the kadmin-backend
    functionality for Heimdal.  The examine function of this backend
    duplicates the output of the MIT getprinc function so that the output
    is compatible with the output of kadmin-backend.  This separate script
    is a temporary measure until both scripts can be refactored as Perl
    modules and use a better method to avoid code duplication.

    Use the Heimdal external program API for password strength checking in
    kadmin-backend-heim and check password strength on create if strength
    checking is enabled for that instance, since the Heimdal kadmin API
    doesn't enforce password strength on passwords changed by
    administrators.

    Allow - in principal names for the examine function.

    Add new config item for each instance, locked.  This optional value
    contains an array of a command and any arguments to it, which is 
    called to determine if the instance is locked for some external 
    policy reason.  If so, the enable command will fail for this instance.

    Significantly improve the error reporting in ksetpass and
    passwd_change by using modern Kerberos error functions where
    available, and avoid Kerberos API calls that are deprecated on
    Heimdal.

kadmin-remctl 2.4 (2009-10-05)

    When enabling or disabling accounts in Active Directory via LDAP, send
    the required "replace: userAccountControl" portion of the LDIF.

    Enable Automake silent rules.  For a quieter build, pass the
    --enable-silent-rules option to configure or build with make V=0.

    Update to rra-c-util 2.0:

    * Sanity-check the results of krb5-config before proceeding.
    * Fall back on manual probing if krb5-config results don't work.
    * Don't break if the user clobbers CPPFLAGS or LDFLAGS at build time.
    * Support Solaris 10's native generic GSS-API libraries.
    * Require Autoconf 2.64 and Automake 1.11.

kadmin-remctl 2.3 (2009-01-07)

    Properly add support for examining principals with instances we don't
    manage.  Previous versions were supposed to support this but didn't
    due to a bug in argument passing.

    Improve the conversion of Kerberos v5 principal names to Kerberos v4
    principal names for examine against an AFS kaserver, although it's
    still not as good as calling the Kerberos library routine would be.

    Attempt to determine if the library directory for remctl (and the
    directory for Kerberos and GSS-API libraries if krb5-config isn't
    found) is lib32 or lib64 instead of lib and set LDFLAGS accordingly.
    Based on an idea from the CMU Autoconf macros.

    Add --with-remctl-include, --with-remctl-lib, --with-gssapi-include,
    --with-gssapi-lib, --with-krb5-include, and --with-krb5-lib configure
    options to allow more specific setting of paths if necessary.

    Check at configure time that we can link with the remctl library we
    found.

kadmin-remctl 2.2 (2008-07-31)

    As of this release, AFS kaserver support is frozen and no longer
    tested.  It may be removed in a future release if there is significant
    code restructuring.

    Close the kasetkey output file descriptor before checking its exit
    status so that we get accurate results.

    Produce better error messages if REMOTE_USER isn't set in the
    environment when checking authorization for instance management and
    document the use of REMOTE_USER in the man page.

kadmin-remctl 2.1 (2008-04-25)

    kasetkey now supports examine, enable, and disable, so drop all
    remaining calls to a Kerberos v4 kadmin client and use kasetkey for
    all AFS kaserver integration.

    Honor allowed regex configuration for valid principal names in examine
    as well.

    Improve the library probing and allow for systems where shared library
    dependencies don't work properly.

    If KRB5_CONFIG was explicitly set in the environment, don't use a
    different krb5-config based on --with-krb4 or --with-krb5.  If
    krb5-config isn't executable, don't use it.  This allows one to force
    library probing by setting KRB5_CONFIG to point to a nonexistent file.

    Sanity-check the results of krb5-config before proceeding and error
    out in configure if they don't work.

kadmin-remctl 2.0 (2008-03-25)

    Significantly rework kadmin-backend.  The configuration variable for
    instance management has been renamed to %CONFIG and now must be set.
    It controls both instances and principals without instances.  Many of
    the global settings have been moved into that hash and can be set
    per-instance.  Particular instances may now be configured to only
    exist in Active Directory and bypass Kerberos v5 entirely.

    Add the ksetpass client, which sets a Kerberos password via the
    password change protocol using an existing Kerberos ticket cache.
    Support using it for password resets in Active Directory and to work
    around a Windows Server 2008 bug that prevents setting passwords at
    the time of account creation when using GSS-API authentication.  Based
    on work by Dmitri Priimak.

    Support enable and disable commands for instance management as well.

    Recognize instance list errors from kadmin correctly.  kadmin returns
    errors prefixed by get_principals, not list_principals.

    Allow for kadmin binaries that print error messages in two parts by
    waiting for the end of the line before extracting the error message.

    When checking against ACLs, support include commands with the same
    syntax as remctld.

    Change some kadmin-backend defaults to be less Stanford-specific.

kadmin-remctl 1.9 (2007-09-11)

    Add support for optionally adding principals with instances created in
    Active Directory to an Active Directory authorization group at the
    time of creation.

kadmin-remctl 1.8 (2007-08-08)

    Increase the timeouts in the Expect calls while performing the actual
    operation, since the propagation to Active Directory can take some
    time.

    When stripping error messages for reporting to the user, don't stop
    stripping at newlines.

    Add a newline after a remctl library error when reporting such errors
    to the user in passwd_change.

kadmin-remctl 1.7 (2007-08-06)

    Add the $K5_HOST configuration variable to kadmin-backend which, if
    set, tells kadmin-backend to contact the given kadmin server instead
    of the default for the local realm.

    Tweak kadmin-backend slightly so that it runs properly with Perl
    5.6.1 without warnings.

kadmin-remctl 1.6 (2007-07-13)

    Use the correct configuration key when reading the LDIF file to find
    the DN for deleting instances and extract just the DN rather than
    keeping the "dn: " prefix.

    Active Directory expects passwords to be encoded in UCS-2LE.  Change
    the password provided to the LDIF template to match those expectations
    and move the modules needed for talking to Active Directory to
    require statements from use statements so that those Perl modules
    aren't required unless Active Directory integration is desired.

    When listing instances, add a wildcard after the instance pattern
    rather than letting kadmin append the local realm so that we can use
    the same code on development servers that may be serving different
    realms than the local realm.

    Correctly handle errors on account creation in kadmin-backend.  It was
    treating all Kerberos errors as success.

    Kerberos v4 examine output faking was prepending "retstr: " even to
    error messages.  Drop "retstr: " when there is an error.

    Standardize across the non-instance functions of kadmin-backend the
    ordering of error and retstr messages and return retstr for the case
    of creating an account that already exists instead of just error.

kadmin-remctl 1.5 (2007-07-11)

    Add support for propagation of instance creation and deletion into
    Active Directory.

    When faking Kerberos v4 examine output in kadmin-backend, strip the
    time zone information from the Kerberos v5 timestamps.  Kerberos v4
    kadmin examine didn't include time zone information.

    Fix the passwd_change configuration documentation to use the correct
    krb5.conf parameters.

kadmin-remctl 1.4 (2007-06-28)

    Add support in passwd_change for reading configuration from the system
    krb5.conf and only use the compiled-in values as defaults.

    Properly handle K4 output faking when the principal doesn't exist.

kadmin-remctl 1.3 (2007-06-11)

    MIT Kerberos kadmin doesn't return a useful exit status in conjunction
    with -q.  It always exits 0, even if the operation failed.  Adjust for
    this by inspecting its output instead.

    Add support for faking K4 kadmin examine output based on the K5
    getprinc output, for backwards compatibility for Stanford Registry
    integration.

kadmin-remctl 1.2 (2007-06-05)

    Support disabling all Kerberos v4 actions in kadmin-backend by setting
    one of the Kerberos v4 configuration variables to undef.

    Handle CRs in the output of commands run via Expect in kadmin-backend.

kadmin-remctl 1.1 (2007-05-31)

    Add support for creating and manipulating account instances to
    kadmin-backend using a separate set of commands.

    Add support in kadmin-backend for loading configuration from an
    external configuration file, which can override the defaults set at
    the top of the script.

    Add support for reserved principals in kadmin-backend (principals that
    the script will refuse to act on).

    For password change and reset, always return both an error: and a
    retstr: line to match the behavior of the old Kerberos v4 interface.
    Strip out the kpasswd advice to see its man page, since that text will
    mostly not be useful to our users.

    On password reset, have kadmin-backend exit with a different exit
    status if the user does not have permission to change passwords for
    that account and use that exit status as a trigger in passwd_change to
    break out of the loop and not keep prompting for a new password.

    Truncate error messages from kpasswd after the first sentence and
    replace newlines with spaces to put them on a single line.  kpasswd is
    more verbose about its errors than kadmin.

kadmin-remctl 1.0 (2007-03-21)

    First public release.  Many defaults are hard-coded into source code
    and synchronization with an AFS kaserver realm is done using
    Stanford-specific external programs.
